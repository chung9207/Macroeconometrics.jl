<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Factor Models · Macroeconometrics.jl</title><meta name="title" content="Factor Models · Macroeconometrics.jl"/><meta property="og:title" content="Factor Models · Macroeconometrics.jl"/><meta property="twitter:title" content="Factor Models · Macroeconometrics.jl"/><meta name="description" content="Documentation for Macroeconometrics.jl."/><meta property="og:description" content="Documentation for Macroeconometrics.jl."/><meta property="twitter:description" content="Documentation for Macroeconometrics.jl."/><meta property="og:url" content="https://chung9207.github.io/Macroeconometrics.jl/factormodels/"/><meta property="twitter:url" content="https://chung9207.github.io/Macroeconometrics.jl/factormodels/"/><link rel="canonical" href="https://chung9207.github.io/Macroeconometrics.jl/factormodels/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Macroeconometrics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../manual/">VAR &amp; BVAR</a></li><li><a class="tocitem" href="../lp/">Local Projections</a></li><li class="is-active"><a class="tocitem" href>Factor Models</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#The-Static-Factor-Model"><span>The Static Factor Model</span></a></li><li><a class="tocitem" href="#Estimation-via-Principal-Components"><span>Estimation via Principal Components</span></a></li><li><a class="tocitem" href="#Determining-the-Number-of-Factors"><span>Determining the Number of Factors</span></a></li><li><a class="tocitem" href="#Scree-Plot-Analysis"><span>Scree Plot Analysis</span></a></li><li><a class="tocitem" href="#Model-Diagnostics"><span>Model Diagnostics</span></a></li><li><a class="tocitem" href="#Applications"><span>Applications</span></a></li><li><a class="tocitem" href="#Asymptotic-Theory"><span>Asymptotic Theory</span></a></li><li><a class="tocitem" href="#Comparison-with-Other-Methods"><span>Comparison with Other Methods</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li class="is-active"><a href>Factor Models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Factor Models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/chung9207/Macroeconometrics.jl/blob/main/docs/src/factormodels.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Factor-Models"><a class="docs-heading-anchor" href="#Factor-Models">Factor Models</a><a id="Factor-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Factor-Models" title="Permalink"></a></h1><p>This chapter covers static factor models for dimensionality reduction in large macroeconomic panels, including estimation via principal components and information criteria for selecting the number of factors.</p><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>Factor models are fundamental tools in macroeconometrics for extracting common sources of variation from large panels of economic indicators. They enable:</p><ol><li><strong>Dimensionality Reduction</strong>: Summarize <span>$N$</span> variables with <span>$r \ll N$</span> factors</li><li><strong>Forecasting</strong>: Use factors as predictors in regressions (diffusion indices)</li><li><strong>Structural Analysis</strong>: Identify common shocks driving multiple series</li><li><strong>FAVAR</strong>: Combine factors with VARs for high-dimensional structural analysis</li></ol><p><strong>Reference</strong>: Stock &amp; Watson (2002a, 2002b), Bai &amp; Ng (2002)</p><hr/><h2 id="The-Static-Factor-Model"><a class="docs-heading-anchor" href="#The-Static-Factor-Model">The Static Factor Model</a><a id="The-Static-Factor-Model-1"></a><a class="docs-heading-anchor-permalink" href="#The-Static-Factor-Model" title="Permalink"></a></h2><h3 id="Model-Specification"><a class="docs-heading-anchor" href="#Model-Specification">Model Specification</a><a id="Model-Specification-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Specification" title="Permalink"></a></h3><p>The static factor model decomposes an <span>$N$</span>-dimensional vector of observables <span>$x_t$</span> into common and idiosyncratic components:</p><p class="math-container">\[x_{it} = \lambda_i&#39; F_t + e_{it}, \quad i = 1, \ldots, N, \quad t = 1, \ldots, T\]</p><p>In matrix form:</p><p class="math-container">\[X = F \Lambda&#39; + E\]</p><p>where:</p><ul><li><span>$X$</span> is the <span>$T \times N$</span> data matrix</li><li><span>$F$</span> is the <span>$T \times r$</span> matrix of latent factors</li><li><span>$\Lambda$</span> is the <span>$N \times r$</span> matrix of factor loadings</li><li><span>$E$</span> is the <span>$T \times N$</span> matrix of idiosyncratic errors</li><li><span>$r$</span> is the number of factors (with <span>$r \ll \min(T, N)$</span>)</li></ul><h3 id="Assumptions"><a class="docs-heading-anchor" href="#Assumptions">Assumptions</a><a id="Assumptions-1"></a><a class="docs-heading-anchor-permalink" href="#Assumptions" title="Permalink"></a></h3><p><strong>Factors and Loadings</strong>:</p><ul><li><span>$E[F_t] = 0$</span>, <span>$\text{Var}(F_t) = I_r$</span> (normalization)</li><li><span>$\frac{1}{T} \sum_t F_t F_t&#39; \xrightarrow{p} \Sigma_F$</span> positive definite</li><li><span>$\frac{1}{N} \Lambda&#39; \Lambda \xrightarrow{p} \Sigma_\Lambda$</span> positive definite</li></ul><p><strong>Idiosyncratic Errors</strong>:</p><ul><li><span>$E[e_{it}] = 0$</span></li><li>Weak cross-sectional and temporal dependence allowed</li><li>Weak correlation with factors: <span>$\frac{1}{NT} \sum_{i,t} |E[F_t e_{it}]| \to 0$</span></li></ul><p><strong>Reference</strong>: Bai &amp; Ng (2002), Bai (2003)</p><hr/><h2 id="Estimation-via-Principal-Components"><a class="docs-heading-anchor" href="#Estimation-via-Principal-Components">Estimation via Principal Components</a><a id="Estimation-via-Principal-Components-1"></a><a class="docs-heading-anchor-permalink" href="#Estimation-via-Principal-Components" title="Permalink"></a></h2><h3 id="Principal-Components-Analysis-(PCA)"><a class="docs-heading-anchor" href="#Principal-Components-Analysis-(PCA)">Principal Components Analysis (PCA)</a><a id="Principal-Components-Analysis-(PCA)-1"></a><a class="docs-heading-anchor-permalink" href="#Principal-Components-Analysis-(PCA)" title="Permalink"></a></h3><p>The factors and loadings are estimated by minimizing the sum of squared idiosyncratic errors:</p><p class="math-container">\[\min_{F, \Lambda} \sum_{i=1}^N \sum_{t=1}^T (x_{it} - \lambda_i&#39; F_t)^2\]</p><p>subject to the normalization <span>$F&#39;F/T = I_r$</span>.</p><h3 id="Solution"><a class="docs-heading-anchor" href="#Solution">Solution</a><a id="Solution-1"></a><a class="docs-heading-anchor-permalink" href="#Solution" title="Permalink"></a></h3><p>The solution involves the eigenvalue decomposition of <span>$X&#39;X$</span> (or <span>$XX&#39;$</span>):</p><p><strong>Case 1</strong>: <span>$T &lt; N$</span> (short panel)</p><ul><li>Compute <span>$XX&#39;$</span> (<span>$T \times T$</span> matrix)</li><li><span>$\hat{F} = \sqrt{T} \times$</span> (first <span>$r$</span> eigenvectors of <span>$XX&#39;$</span>)</li><li><span>$\hat{\Lambda} = X&#39; \hat{F} / T$</span></li></ul><p><strong>Case 2</strong>: <span>$N \leq T$</span> (tall panel)</p><ul><li>Compute <span>$X&#39;X$</span> (<span>$N \times N$</span> matrix)</li><li><span>$\hat{\Lambda} = \sqrt{N} \times$</span> (first <span>$r$</span> eigenvectors of <span>$X&#39;X$</span>)</li><li><span>$\hat{F} = X \hat{\Lambda} / N$</span></li></ul><h3 id="Data-Preprocessing"><a class="docs-heading-anchor" href="#Data-Preprocessing">Data Preprocessing</a><a id="Data-Preprocessing-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Preprocessing" title="Permalink"></a></h3><p>Before estimation, data is typically:</p><ol><li><strong>Demeaned</strong>: Center each series to have zero mean</li><li><strong>Standardized</strong>: Scale each series to have unit variance</li></ol><p>This prevents high-variance series from dominating the factor extraction.</p><h3 id="Identification"><a class="docs-heading-anchor" href="#Identification">Identification</a><a id="Identification-1"></a><a class="docs-heading-anchor-permalink" href="#Identification" title="Permalink"></a></h3><p>The factors and loadings are identified only up to an <span>$r \times r$</span> invertible rotation. If <span>$(F, \Lambda)$</span> is a solution, so is <span>$(FH, \Lambda H^{-1})$</span> for any invertible <span>$H$</span>.</p><p>The normalization <span>$F&#39;F/T = I_r$</span> and <span>$\Lambda&#39;\Lambda$</span> diagonal pins down rotation up to sign.</p><p><strong>Reference</strong>: Stock &amp; Watson (2002a), Bai &amp; Ng (2002)</p><h3 id="Julia-Implementation"><a class="docs-heading-anchor" href="#Julia-Implementation">Julia Implementation</a><a id="Julia-Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Julia-Implementation" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Macroeconometrics

# X is T×N data matrix
# Estimate r-factor model

model = estimate_factors(X, r;
    standardize = true,    # Standardize data
    method = :pca          # Principal components
)

# Access results
F = model.factors          # T×r estimated factors
Λ = model.loadings         # N×r estimated loadings</code></pre><hr/><h2 id="Determining-the-Number-of-Factors"><a class="docs-heading-anchor" href="#Determining-the-Number-of-Factors">Determining the Number of Factors</a><a id="Determining-the-Number-of-Factors-1"></a><a class="docs-heading-anchor-permalink" href="#Determining-the-Number-of-Factors" title="Permalink"></a></h2><h3 id="The-Selection-Problem"><a class="docs-heading-anchor" href="#The-Selection-Problem">The Selection Problem</a><a id="The-Selection-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#The-Selection-Problem" title="Permalink"></a></h3><p>Choosing <span>$r$</span> is crucial:</p><ul><li>Too few factors: Omitted common variation, biased estimates</li><li>Too many factors: Overfitting, including noise as signal</li></ul><h3 id="Bai-and-Ng-(2002)-Information-Criteria"><a class="docs-heading-anchor" href="#Bai-and-Ng-(2002)-Information-Criteria">Bai &amp; Ng (2002) Information Criteria</a><a id="Bai-and-Ng-(2002)-Information-Criteria-1"></a><a class="docs-heading-anchor-permalink" href="#Bai-and-Ng-(2002)-Information-Criteria" title="Permalink"></a></h3><p>Bai &amp; Ng propose three information criteria:</p><p><strong>IC1</strong>:</p><p class="math-container">\[IC_1(r) = \log \hat{\sigma}^2(r) + r \cdot \frac{N + T}{NT} \log\left( \frac{NT}{N+T} \right)\]</p><p><strong>IC2</strong>:</p><p class="math-container">\[IC_2(r) = \log \hat{\sigma}^2(r) + r \cdot \frac{N + T}{NT} \log(C_{NT}^2)\]</p><p><strong>IC3</strong>:</p><p class="math-container">\[IC_3(r) = \log \hat{\sigma}^2(r) + r \cdot \frac{\log(C_{NT}^2)}{C_{NT}^2}\]</p><p>where:</p><ul><li><span>$\hat{\sigma}^2(r) = \frac{1}{NT} \sum_{i,t} \hat{e}_{it}^2$</span> is the average squared residual</li><li><span>$C_{NT}^2 = \min(N, T)$</span></li></ul><p><strong>Selection Rule</strong>: Choose <span>$\hat{r}$</span> that minimizes <span>$IC_k(r)$</span> over <span>$r \in \{1, \ldots, r_{max}\}$</span>.</p><p><strong>Properties</strong>:</p><ul><li>IC2 and IC3 perform best in simulations</li><li>All three are consistent: <span>$\hat{r} \xrightarrow{p} r_0$</span> as <span>$N, T \to \infty$</span></li></ul><p><strong>Reference</strong>: Bai &amp; Ng (2002)</p><h3 id="Julia-Implementation-2"><a class="docs-heading-anchor" href="#Julia-Implementation-2">Julia Implementation</a><a class="docs-heading-anchor-permalink" href="#Julia-Implementation-2" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Macroeconometrics

# Compute IC for r = 1, ..., r_max
r_max = 10
ic = ic_criteria(X, r_max)

# Optimal number by each criterion
println(&quot;IC1 selects: &quot;, ic.r_IC1, &quot; factors&quot;)
println(&quot;IC2 selects: &quot;, ic.r_IC2, &quot; factors&quot;)
println(&quot;IC3 selects: &quot;, ic.r_IC3, &quot; factors&quot;)

# IC values for all r
for r in 1:r_max
    println(&quot;r=$r: IC1=$(ic.IC1[r]), IC2=$(ic.IC2[r]), IC3=$(ic.IC3[r])&quot;)
end</code></pre><hr/><h2 id="Scree-Plot-Analysis"><a class="docs-heading-anchor" href="#Scree-Plot-Analysis">Scree Plot Analysis</a><a id="Scree-Plot-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Scree-Plot-Analysis" title="Permalink"></a></h2><h3 id="Visual-Factor-Selection"><a class="docs-heading-anchor" href="#Visual-Factor-Selection">Visual Factor Selection</a><a id="Visual-Factor-Selection-1"></a><a class="docs-heading-anchor-permalink" href="#Visual-Factor-Selection" title="Permalink"></a></h3><p>The scree plot displays eigenvalues (or variance explained) against factor number. The &quot;elbow&quot; in the plot suggests the number of significant factors.</p><h3 id="Variance-Explained"><a class="docs-heading-anchor" href="#Variance-Explained">Variance Explained</a><a id="Variance-Explained-1"></a><a class="docs-heading-anchor-permalink" href="#Variance-Explained" title="Permalink"></a></h3><p>For each factor <span>$j$</span>:</p><p><strong>Individual Variance</strong>:</p><p class="math-container">\[\text{VarExp}_j = \frac{\mu_j}{\sum_{k=1}^N \mu_k}\]</p><p><strong>Cumulative Variance</strong>:</p><p class="math-container">\[\text{CumVarExp}_r = \sum_{j=1}^r \text{VarExp}_j\]</p><p>where <span>$\mu_j$</span> is the <span>$j$</span>-th largest eigenvalue of <span>$X&#39;X/T$</span> (or <span>$XX&#39;/N$</span>).</p><h3 id="Julia-Implementation-3"><a class="docs-heading-anchor" href="#Julia-Implementation-3">Julia Implementation</a><a class="docs-heading-anchor-permalink" href="#Julia-Implementation-3" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Macroeconometrics

model = estimate_factors(X, r)

# Get scree plot data
scree = scree_plot_data(model)

# Variance explained
for j in 1:min(10, length(scree.factors))
    println(&quot;Factor $j: $(round(scree.explained_variance[j]*100, digits=2))% &quot;,
            &quot;(cumulative: $(round(scree.cumulative_variance[j]*100, digits=2))%)&quot;)
end</code></pre><hr/><h2 id="Model-Diagnostics"><a class="docs-heading-anchor" href="#Model-Diagnostics">Model Diagnostics</a><a id="Model-Diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Diagnostics" title="Permalink"></a></h2><h3 id="R-squared-for-Each-Variable"><a class="docs-heading-anchor" href="#R-squared-for-Each-Variable">R-squared for Each Variable</a><a id="R-squared-for-Each-Variable-1"></a><a class="docs-heading-anchor-permalink" href="#R-squared-for-Each-Variable" title="Permalink"></a></h3><p>The <span>$R^2$</span> measures how much of variable <span>$i$</span>&#39;s variation is explained by the common factors:</p><p class="math-container">\[R^2_i = 1 - \frac{\sum_t \hat{e}_{it}^2}{\sum_t (x_{it} - \bar{x}_i)^2}\]</p><p>Variables with low <span>$R^2$</span> are mainly driven by idiosyncratic shocks.</p><h3 id="Julia-Implementation-4"><a class="docs-heading-anchor" href="#Julia-Implementation-4">Julia Implementation</a><a class="docs-heading-anchor-permalink" href="#Julia-Implementation-4" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Macroeconometrics

model = estimate_factors(X, r)

# R² for each variable
r2_values = r2(model)

# Summary statistics
println(&quot;Mean R²: &quot;, round(mean(r2_values), digits=3))
println(&quot;Median R²: &quot;, round(median(r2_values), digits=3))
println(&quot;Min R²: &quot;, round(minimum(r2_values), digits=3))
println(&quot;Max R²: &quot;, round(maximum(r2_values), digits=3))

# Variables well-explained by factors
well_explained = findall(r2_values .&gt; 0.7)</code></pre><h3 id="Fitted-Values-and-Residuals"><a class="docs-heading-anchor" href="#Fitted-Values-and-Residuals">Fitted Values and Residuals</a><a id="Fitted-Values-and-Residuals-1"></a><a class="docs-heading-anchor-permalink" href="#Fitted-Values-and-Residuals" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Fitted values: X̂ = FΛ&#39;
X_fitted = predict(model)

# Residuals: E = X - X̂
resid = residuals(model)

# Model statistics
println(&quot;Number of observations: &quot;, nobs(model))
println(&quot;Degrees of freedom: &quot;, dof(model))</code></pre><hr/><h2 id="Applications"><a class="docs-heading-anchor" href="#Applications">Applications</a><a id="Applications-1"></a><a class="docs-heading-anchor-permalink" href="#Applications" title="Permalink"></a></h2><h3 id="Diffusion-Index-Forecasting"><a class="docs-heading-anchor" href="#Diffusion-Index-Forecasting">Diffusion Index Forecasting</a><a id="Diffusion-Index-Forecasting-1"></a><a class="docs-heading-anchor-permalink" href="#Diffusion-Index-Forecasting" title="Permalink"></a></h3><p>Use factors as predictors for forecasting a target variable <span>$y_{t+h}$</span>:</p><p class="math-container">\[y_{t+h} = \alpha + \beta&#39; \hat{F}_t + \gamma&#39; y_{t:t-p} + \varepsilon_{t+h}\]</p><p>Factors summarize information from a large panel, improving forecast accuracy.</p><p><strong>Reference</strong>: Stock &amp; Watson (2002b)</p><h3 id="Factor-Augmented-VAR-(FAVAR)"><a class="docs-heading-anchor" href="#Factor-Augmented-VAR-(FAVAR)">Factor-Augmented VAR (FAVAR)</a><a id="Factor-Augmented-VAR-(FAVAR)-1"></a><a class="docs-heading-anchor-permalink" href="#Factor-Augmented-VAR-(FAVAR)" title="Permalink"></a></h3><p>Combine factors with key observable variables in a VAR:</p><p class="math-container">\[\begin{bmatrix} y_t \\ F_t \end{bmatrix} = A_1 \begin{bmatrix} y_{t-1} \\ F_{t-1} \end{bmatrix} + \cdots + A_p \begin{bmatrix} y_{t-p} \\ F_{t-p} \end{bmatrix} + u_t\]</p><p>This allows structural analysis with high-dimensional information sets.</p><p><strong>Reference</strong>: Bernanke, Boivin &amp; Eliasz (2005)</p><h3 id="Example:-FAVAR-Setup"><a class="docs-heading-anchor" href="#Example:-FAVAR-Setup">Example: FAVAR Setup</a><a id="Example:-FAVAR-Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-FAVAR-Setup" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Macroeconometrics

# Estimate factors from large panel X
fm = estimate_factors(X, r)
F = fm.factors

# Combine with key observables (e.g., FFR, GDP, inflation)
Y_key = data[:, [:FFR, :GDP, :CPI]]
Y_favar = hcat(Y_key, F)

# Estimate FAVAR
favar_model = fit(VARModel, Y_favar, p)

# Structural analysis
irf_favar = irf(favar_model, H; method=:cholesky)</code></pre><hr/><h2 id="Asymptotic-Theory"><a class="docs-heading-anchor" href="#Asymptotic-Theory">Asymptotic Theory</a><a id="Asymptotic-Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Asymptotic-Theory" title="Permalink"></a></h2><h3 id="Consistency-of-Factor-Estimates"><a class="docs-heading-anchor" href="#Consistency-of-Factor-Estimates">Consistency of Factor Estimates</a><a id="Consistency-of-Factor-Estimates-1"></a><a class="docs-heading-anchor-permalink" href="#Consistency-of-Factor-Estimates" title="Permalink"></a></h3><p>Under the assumptions of Bai &amp; Ng (2002), as <span>$T, N \to \infty$</span>:</p><p class="math-container">\[\frac{1}{T} \sum_{t=1}^T \|\hat{F}_t - H F_t\|^2 = O_p\left( \frac{1}{\min(N, T)} \right)\]</p><p>where <span>$H$</span> is an <span>$r \times r$</span> rotation matrix.</p><p>The factors are consistently estimated up to rotation at rate <span>$\min(\sqrt{N}, \sqrt{T})$</span>.</p><h3 id="Distribution-Theory"><a class="docs-heading-anchor" href="#Distribution-Theory">Distribution Theory</a><a id="Distribution-Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Distribution-Theory" title="Permalink"></a></h3><p>For large <span>$N, T$</span>, the factor estimates are asymptotically normal:</p><p class="math-container">\[\sqrt{T} (\hat{F}_t - H F_t) \xrightarrow{d} N(0, V)\]</p><p>where <span>$V$</span> depends on the cross-sectional and temporal dependence structure.</p><p><strong>Reference</strong>: Bai (2003), Bai &amp; Ng (2006)</p><hr/><h2 id="Comparison-with-Other-Methods"><a class="docs-heading-anchor" href="#Comparison-with-Other-Methods">Comparison with Other Methods</a><a id="Comparison-with-Other-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-with-Other-Methods" title="Permalink"></a></h2><h3 id="Static-vs.-Dynamic-Factor-Models"><a class="docs-heading-anchor" href="#Static-vs.-Dynamic-Factor-Models">Static vs. Dynamic Factor Models</a><a id="Static-vs.-Dynamic-Factor-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Static-vs.-Dynamic-Factor-Models" title="Permalink"></a></h3><table><tr><th style="text-align: right">Aspect</th><th style="text-align: right">Static FM</th><th style="text-align: right">Dynamic FM</th></tr><tr><td style="text-align: right"><strong>Model</strong></td><td style="text-align: right"><span>$X_t = \Lambda F_t + e_t$</span></td><td style="text-align: right"><span>$X_t = \Lambda(L) f_t + e_t$</span></td></tr><tr><td style="text-align: right"><strong>Factors</strong></td><td style="text-align: right">Contemporaneous</td><td style="text-align: right">May include lags</td></tr><tr><td style="text-align: right"><strong>Estimation</strong></td><td style="text-align: right">PCA</td><td style="text-align: right">Spectral methods, Kalman filter</td></tr><tr><td style="text-align: right"><strong>Use case</strong></td><td style="text-align: right">Large N, moderate T</td><td style="text-align: right">Time series dynamics important</td></tr></table><p><strong>Reference</strong>: Forni, Hallin, Lippi &amp; Reichlin (2000)</p><h3 id="Maximum-Likelihood-Estimation"><a class="docs-heading-anchor" href="#Maximum-Likelihood-Estimation">Maximum Likelihood Estimation</a><a id="Maximum-Likelihood-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Maximum-Likelihood-Estimation" title="Permalink"></a></h3><p>ML estimation assumes Gaussian factors and errors:</p><p class="math-container">\[F_t \sim N(0, I_r), \quad e_t \sim N(0, \Psi)\]</p><p>Estimated via EM algorithm. More efficient than PCA if model is correctly specified, but computationally intensive.</p><hr/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><h3 id="Core-Theory"><a class="docs-heading-anchor" href="#Core-Theory">Core Theory</a><a id="Core-Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Theory" title="Permalink"></a></h3><ul><li>Bai, J. (2003). &quot;Inferential Theory for Factor Models of Large Dimensions.&quot; <em>Econometrica</em>, 71(1), 135-171.</li><li>Bai, J., &amp; Ng, S. (2002). &quot;Determining the Number of Factors in Approximate Factor Models.&quot; <em>Econometrica</em>, 70(1), 191-221.</li><li>Bai, J., &amp; Ng, S. (2006). &quot;Confidence Intervals for Diffusion Index Forecasts and Inference for Factor-Augmented Regressions.&quot; <em>Econometrica</em>, 74(4), 1133-1150.</li><li>Stock, J. H., &amp; Watson, M. W. (2002a). &quot;Forecasting Using Principal Components from a Large Number of Predictors.&quot; <em>Journal of the American Statistical Association</em>, 97(460), 1167-1179.</li><li>Stock, J. H., &amp; Watson, M. W. (2002b). &quot;Macroeconomic Forecasting Using Diffusion Indexes.&quot; <em>Journal of Business &amp; Economic Statistics</em>, 20(2), 147-162.</li></ul><h3 id="Applications-2"><a class="docs-heading-anchor" href="#Applications-2">Applications</a><a class="docs-heading-anchor-permalink" href="#Applications-2" title="Permalink"></a></h3><ul><li>Bernanke, B. S., Boivin, J., &amp; Eliasz, P. (2005). &quot;Measuring the Effects of Monetary Policy: A Factor-Augmented Vector Autoregressive (FAVAR) Approach.&quot; <em>Quarterly Journal of Economics</em>, 120(1), 387-422.</li><li>Forni, M., Hallin, M., Lippi, M., &amp; Reichlin, L. (2000). &quot;The Generalized Dynamic-Factor Model: Identification and Estimation.&quot; <em>Review of Economics and Statistics</em>, 82(4), 540-554.</li><li>McCracken, M. W., &amp; Ng, S. (2016). &quot;FRED-MD: A Monthly Database for Macroeconomic Research.&quot; <em>Journal of Business &amp; Economic Statistics</em>, 34(4), 574-589.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lp/">« Local Projections</a><a class="docs-footer-nextpage" href="../examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 30 January 2026 21:31">Friday 30 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
